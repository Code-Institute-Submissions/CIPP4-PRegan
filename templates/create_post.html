{% extends 'base.html' %}
{% block content %}
  <h2>Create Post</h2>
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.post_type }}
    {{ form.title }}
    <div id="text_fields">
      {{ form.content }}
    </div>
    <div id="image_fields" style="display: none;">
      {{ form.image }}
      {% if form.image.errors %}
        <ul class="errorlist">
          {% for error in form.image.errors %}
            <li>{{ error }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>
    <div id="video_fields" style="display: none;">
      {{ form.video }}
      {% if form.video.errors %}
        <ul class="errorlist">
          {% for error in form.video.errors %}
            <li>{{ error }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>
    <input type="submit" value="Create Post">
  </form>
  <script>
    $(document).ready(function() {
      $('#id_post_type').change(function() {
        var selectedType = $(this).val();
        if (selectedType === 'text') {
          $('#text_fields').show();
          $('#image_fields').hide();
          $('#video_fields').hide();
          $('#id_image').prop('required', false);
          $('#id_video').prop('required', false);
        } else if (selectedType === 'image') {
          $('#text_fields').hide();
          $('#image_fields').show();
          $('#video_fields').hide();
          $('#id_image').prop('required', true);
          $('#id_video').prop('required', false);
        } else if (selectedType === 'video') {
          $('#text_fields').hide();
          $('#image_fields').hide();
          $('#video_fields').show();
          $('#id_image').prop('required', false);
          $('#id_video').prop('required', true);
        } else {
          $('#text_fields').hide();
          $('#image_fields').hide();
          $('#video_fields').hide();
          $('#id_image').prop('required', false);
          $('#id_video').prop('required', false);
        }
      });
    });
  </script>
{% endblock %}