{% extends 'base.html' %}
{% block content %}
  <div class="form-container">
    <h2 style="text-align: left; margin-bottom: 80px;">Create Post</h2>
    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <div class="form-group">
        <label for="{{ form.post_type.id_for_label }}">Post Type:</label>
        {{ form.post_type }}
      </div>
      <div class="form-group">
        <h4>Title</h4>
        {{ form.title }}
      </div>
      <div id="text_fields">
        <div class="form-group">
          <h4>Content</h4>
          {{ form.content }}
        </div>
      </div>
      <div id="image_fields" style="display: none;">
        <div class="form-group">
          <h4>Image</h4>
          {{ form.image }}
          {% if form.image.errors %}
            <ul class="errorlist">
              {% for error in form.image.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
          <div class="file-size-warning">File size limit: 10MB</div>
        </div>
      </div>
      <div id="video_fields" style="display: none;">
        <div class="form-group">
          <h4>Video</h4>
          {{ form.video }}
          {% if form.video.errors %}
            <ul class="errorlist">
              {% for error in form.video.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
          <div class="file-size-warning">File size limit: 100MB</div>
        </div>
      </div>
      <div class="d-flex justify-content-center"><input class="mb-4" type="submit" value="Create Post"></div>
      
    </form>
  </div>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function() {
      $('#id_post_type').change(function() {
        var selectedType = $(this).val();
        if (selectedType === 'text') {
          $('#text_fields').show();
          $('#image_fields').hide();
          $('#video_fields').hide();
          $('#id_image').prop('required', false);
          $('#id_video').prop('required', false);
        } else if (selectedType === 'image') {
          $('#text_fields').hide();
          $('#image_fields').show();
          $('#video_fields').hide();
          $('#id_image').prop('required', true);
          $('#id_video').prop('required', false);
        } else if (selectedType === 'video') {
          $('#text_fields').hide();
          $('#image_fields').hide();
          $('#video_fields').show();
          $('#id_image').prop('required', false);
          $('#id_video').prop('required', true);
        } else {
          $('#text_fields').hide();
          $('#image_fields').hide();
          $('#video_fields').hide();
          $('#id_image').prop('required', false);
          $('#id_video').prop('required', false);
        }
      });
    });
  </script>
{% endblock %}
